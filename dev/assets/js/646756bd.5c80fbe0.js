"use strict";(globalThis.webpackChunkunderthesea_docs=globalThis.webpackChunkunderthesea_docs||[]).push([[5507],{4780(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>o,frontMatter:()=>l,metadata:()=>i,toc:()=>a});var i=s(9413),r=s(4848),t=s(8453);const l={slug:"rust-text-classifier",title:"Rust-Powered Text Classification",authors:["rain1024"],tags:["rust","performance","classification","nlp"]},d="Rust-Powered Text Classification",c={authorsImageUrls:[void 0]},a=[{value:"Background",id:"background",level:2},{value:"The Architecture Change",id:"the-architecture-change",level:2},{value:"Before (sklearn-based)",id:"before-sklearn-based",level:3},{value:"After (Rust-based)",id:"after-rust-based",level:3},{value:"Code Changes",id:"code-changes",level:2},{value:"Benchmark Results",id:"benchmark-results",level:2},{value:"Why Is It Faster?",id:"why-is-it-faster",level:2},{value:"1. Fused Pipeline",id:"1-fused-pipeline",level:3},{value:"2. Optimized Sparse Operations",id:"2-optimized-sparse-operations",level:3},{value:"3. Single File Model",id:"3-single-file-model",level:3},{value:"4. No Python GIL Contention",id:"4-no-python-gil-contention",level:3},{value:"The Models",id:"the-models",level:2},{value:"sen-classifier-general",id:"sen-classifier-general",level:3},{value:"sen-classifier-bank",id:"sen-classifier-bank",level:3},{value:"Training Pipeline",id:"training-pipeline",level:2},{value:"Label Format Change",id:"label-format-change",level:2},{value:"Simplified Codebase",id:"simplified-codebase",level:2},{value:"Try It Out",id:"try-it-out",level:2},{value:"Links",id:"links",level:2}];function h(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["In underthesea v9.2.9, we've completely rewritten the text classification pipeline using our Rust-based ",(0,r.jsx)(n.code,{children:"TextClassifier"}),". This delivers up to ",(0,r.jsx)(n.strong,{children:"273x faster inference"})," compared to the previous sklearn-based implementation."]}),"\n",(0,r.jsx)(n.h2,{id:"background",children:"Background"}),"\n",(0,r.jsx)(n.p,{children:"Text classification in underthesea supports two domains:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"General"}),": News categorization (10 categories)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Bank"}),": Banking intent classification (14 categories)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Previously, we used scikit-learn's ",(0,r.jsx)(n.code,{children:"TfidfVectorizer"})," + ",(0,r.jsx)(n.code,{children:"LinearSVC"})," loaded via joblib. While accurate, this approach had significant overhead."]}),"\n",(0,r.jsx)(n.h2,{id:"the-architecture-change",children:"The Architecture Change"}),"\n",(0,r.jsx)(n.h3,{id:"before-sklearn-based",children:"Before (sklearn-based)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        Python                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502    Input     \u2502\u2500\u2500\u2500\u25b6\u2502TfidfVectorizer\u2500\u2500\u2500\u25b6\u2502  LinearSVC   \u2502  \u2502\n\u2502  \u2502    Text      \u2502    \u2502  (sklearn)   \u2502    \u2502  (sklearn)   \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                              \u2502                   \u2502          \u2502\n\u2502                      joblib.load()        joblib.load()     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(n.p,{children:"Loading two separate pickle files, with Python-based vectorization and inference."}),"\n",(0,r.jsx)(n.h3,{id:"after-rust-based",children:"After (Rust-based)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        Python                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502    Input     \u2502\u2500\u2500\u2500\u25b6\u2502         TextClassifier           \u2502  \u2502\n\u2502  \u2502    Text      \u2502    \u2502  TF-IDF + LinearSVC (Rust)       \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                              \u2502                              \u2502\n\u2502                      single .bin file                       \u2502\n\u2502                      underthesea-core                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(n.p,{children:"Single binary model file, vectorization and inference fused in Rust."}),"\n",(0,r.jsx)(n.h2,{id:"code-changes",children:"Code Changes"}),"\n",(0,r.jsx)(n.p,{children:"The API remains unchanged:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from underthesea import classify\n\n# General classification\nclassify("Vi\u1ec7t Nam v\xf4 \u0111\u1ecbch AFF Cup")\n# "The thao"\n\n# Bank domain\nclassify("L\xe3i su\u1ea5t ti\u1ebft ki\u1ec7m bao nhi\xeau?", domain="bank")\n# [\'INTEREST_RATE\']\n'})}),"\n",(0,r.jsx)(n.p,{children:"Internally, the implementation is much simpler:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Before:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import joblib\nfrom underthesea.pipeline.classification import bank\n\nvectorizer = joblib.load("vectorizer.pkl")\nclassifier = joblib.load("classifier.pkl")\nfeatures = vectorizer.transform([text])\nprediction = classifier.predict(features)\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"After:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from underthesea_core import TextClassifier\n\nclassifier = TextClassifier.load("model.bin")\nprediction = classifier.predict(text)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"benchmark-results",children:"Benchmark Results"}),"\n",(0,r.jsx)(n.p,{children:"Tested on the same hardware with batch inference:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Domain"}),(0,r.jsx)(n.th,{children:"sklearn"}),(0,r.jsx)(n.th,{children:"Rust"}),(0,r.jsx)(n.th,{children:"Speedup"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"General"}),(0,r.jsx)(n.td,{children:"1,228 samples/sec"}),(0,r.jsx)(n.td,{children:"66,678 samples/sec"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"54x"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Bank"}),(0,r.jsx)(n.td,{children:"244 samples/sec"}),(0,r.jsx)(n.td,{children:"66,678 samples/sec"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"273x"})})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["Single sample latency: ",(0,r.jsx)(n.strong,{children:"4ms \u2192 0.465ms"})]}),"\n",(0,r.jsx)(n.h2,{id:"why-is-it-faster",children:"Why Is It Faster?"}),"\n",(0,r.jsx)(n.h3,{id:"1-fused-pipeline",children:"1. Fused Pipeline"}),"\n",(0,r.jsx)(n.p,{children:"TF-IDF vectorization and SVM inference run in a single Rust function call, eliminating Python overhead between stages."}),"\n",(0,r.jsx)(n.h3,{id:"2-optimized-sparse-operations",children:"2. Optimized Sparse Operations"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"pub fn predict(&self, text: &str) -> String {\n    // Tokenize and hash features in one pass\n    let features = self.vectorizer.transform(text);\n\n    // Sparse dot product with pre-sorted indices\n    let scores = self.svm.decision_function(&features);\n\n    self.classes[scores.argmax()].clone()\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-single-file-model",children:"3. Single File Model"}),"\n",(0,r.jsxs)(n.p,{children:["One ",(0,r.jsx)(n.code,{children:".bin"})," file instead of multiple pickle files:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Faster loading"}),"\n",(0,r.jsx)(n.li,{children:"Atomic deployment"}),"\n",(0,r.jsx)(n.li,{children:"Smaller size (JSON-based, not pickle)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"4-no-python-gil-contention",children:"4. No Python GIL Contention"}),"\n",(0,r.jsx)(n.p,{children:"Rust code releases the GIL during computation, enabling true parallelism."}),"\n",(0,r.jsx)(n.h2,{id:"the-models",children:"The Models"}),"\n",(0,r.jsx)(n.h3,{id:"sen-classifier-general",children:"sen-classifier-general"}),"\n",(0,r.jsx)(n.p,{children:"General Vietnamese news classification model trained on VNTC dataset."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Training Data:"})," ",(0,r.jsx)(n.a,{href:"https://github.com/duyvuleo/VNTC",children:"VNTC"})," (Vietnamese News Text Classification)"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"33,759 training samples"}),"\n",(0,r.jsx)(n.li,{children:"50,373 test samples"}),"\n",(0,r.jsx)(n.li,{children:"10 news categories"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Categories:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Label"}),(0,r.jsx)(n.th,{children:"Vietnamese"}),(0,r.jsx)(n.th,{children:"English"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Chinh tri Xa hoi"}),(0,r.jsx)(n.td,{children:"Ch\xednh tr\u1ecb X\xe3 h\u1ed9i"}),(0,r.jsx)(n.td,{children:"Politics/Society"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Doi song"}),(0,r.jsx)(n.td,{children:"\u0110\u1eddi s\u1ed1ng"}),(0,r.jsx)(n.td,{children:"Lifestyle"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Khoa hoc"}),(0,r.jsx)(n.td,{children:"Khoa h\u1ecdc"}),(0,r.jsx)(n.td,{children:"Science"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Kinh doanh"}),(0,r.jsx)(n.td,{children:"Kinh doanh"}),(0,r.jsx)(n.td,{children:"Business"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Phap luat"}),(0,r.jsx)(n.td,{children:"Ph\xe1p lu\u1eadt"}),(0,r.jsx)(n.td,{children:"Law"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Suc khoe"}),(0,r.jsx)(n.td,{children:"S\u1ee9c kh\u1ecfe"}),(0,r.jsx)(n.td,{children:"Health"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"The gioi"}),(0,r.jsx)(n.td,{children:"Th\u1ebf gi\u1edbi"}),(0,r.jsx)(n.td,{children:"World"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"The thao"}),(0,r.jsx)(n.td,{children:"Th\u1ec3 thao"}),(0,r.jsx)(n.td,{children:"Sports"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Van hoa"}),(0,r.jsx)(n.td,{children:"V\u0103n h\xf3a"}),(0,r.jsx)(n.td,{children:"Culture"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Vi tinh"}),(0,r.jsx)(n.td,{children:"Vi t\xednh"}),(0,r.jsx)(n.td,{children:"Technology"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Performance:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Accuracy: ",(0,r.jsx)(n.strong,{children:"92.49%"})]}),"\n",(0,r.jsx)(n.li,{children:"F1 (weighted): 92.40%"}),"\n",(0,r.jsx)(n.li,{children:"Training time: 37.6s"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"sen-classifier-bank",children:"sen-classifier-bank"}),"\n",(0,r.jsx)(n.p,{children:"Vietnamese banking intent classification model trained on UTS2017_Bank dataset."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Training Data:"})," ",(0,r.jsx)(n.a,{href:"https://huggingface.co/datasets/undertheseanlp/UTS2017_Bank",children:"UTS2017_Bank"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"1,581 training samples"}),"\n",(0,r.jsx)(n.li,{children:"396 test samples"}),"\n",(0,r.jsx)(n.li,{children:"14 banking categories"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Categories:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Label"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Samples"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CUSTOMER_SUPPORT"}),(0,r.jsx)(n.td,{children:"Customer support queries"}),(0,r.jsx)(n.td,{children:"774"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"TRADEMARK"}),(0,r.jsx)(n.td,{children:"Brand/trademark mentions"}),(0,r.jsx)(n.td,{children:"697"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"LOAN"}),(0,r.jsx)(n.td,{children:"Loan services"}),(0,r.jsx)(n.td,{children:"73"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"INTERNET_BANKING"}),(0,r.jsx)(n.td,{children:"Internet banking"}),(0,r.jsx)(n.td,{children:"69"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CARD"}),(0,r.jsx)(n.td,{children:"Card services"}),(0,r.jsx)(n.td,{children:"66"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"INTEREST_RATE"}),(0,r.jsx)(n.td,{children:"Interest rates"}),(0,r.jsx)(n.td,{children:"58"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PROMOTION"}),(0,r.jsx)(n.td,{children:"Promotions"}),(0,r.jsx)(n.td,{children:"56"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"DISCOUNT"}),(0,r.jsx)(n.td,{children:"Discounts"}),(0,r.jsx)(n.td,{children:"40"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"MONEY_TRANSFER"}),(0,r.jsx)(n.td,{children:"Money transfer"}),(0,r.jsx)(n.td,{children:"37"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"OTHER"}),(0,r.jsx)(n.td,{children:"Other queries"}),(0,r.jsx)(n.td,{children:"70"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PAYMENT"}),(0,r.jsx)(n.td,{children:"Payment services"}),(0,r.jsx)(n.td,{children:"17"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"SAVING"}),(0,r.jsx)(n.td,{children:"Savings"}),(0,r.jsx)(n.td,{children:"12"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ACCOUNT"}),(0,r.jsx)(n.td,{children:"Account services"}),(0,r.jsx)(n.td,{children:"5"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"SECURITY"}),(0,r.jsx)(n.td,{children:"Security"}),(0,r.jsx)(n.td,{children:"3"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Performance:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Accuracy: ",(0,r.jsx)(n.strong,{children:"75.76%"})," (+3.29% vs previous sonar_core_1)"]}),"\n",(0,r.jsx)(n.li,{children:"F1 (weighted): 72.70%"}),"\n",(0,r.jsx)(n.li,{children:"Training time: 0.13s"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"training-pipeline",children:"Training Pipeline"}),"\n",(0,r.jsx)(n.p,{children:"Both models use a 3-stage TF-IDF + Linear SVM pipeline:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Input Text\n    \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CountVectorizer                    \u2502\n\u2502  - max_features: 20,000             \u2502\n\u2502  - ngram_range: (1, 2)              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  TfidfTransformer                   \u2502\n\u2502  - use_idf: True                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  LinearSVC                          \u2502\n\u2502  - C: 1.0                           \u2502\n\u2502  - max_iter: 2000                   \u2502\n\u2502  - loss: squared_hinge              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2193\nPredicted Label + Confidence\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key design decisions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Syllable-level tokenization"}),": No word segmentation for speed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Character n-grams (1-2)"}),": Captures Vietnamese morphology"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"20K vocabulary"}),": Balances accuracy and model size"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Linear SVM"}),": Fast training, works well with sparse high-dimensional data"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Training code: ",(0,r.jsx)(n.a,{href:"https://github.com/undertheseanlp/sen-1",children:"sen-1/src/scripts/train_vntc.py"})]}),"\n",(0,r.jsx)(n.h2,{id:"label-format-change",children:"Label Format Change"}),"\n",(0,r.jsx)(n.p,{children:"Labels now use Title case with spaces:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Old"}),(0,r.jsx)(n.th,{children:"New"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"the_thao"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"The thao"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"kinh_doanh"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Kinh doanh"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"vi_tinh"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Vi tinh"})})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["Bank domain labels remain uppercase: ",(0,r.jsx)(n.code,{children:"INTEREST_RATE"}),", ",(0,r.jsx)(n.code,{children:"MONEY_TRANSFER"}),", etc."]}),"\n",(0,r.jsx)(n.h2,{id:"simplified-codebase",children:"Simplified Codebase"}),"\n",(0,r.jsx)(n.p,{children:"We consolidated three separate modules into one:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Before:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"classification/\n\u251c\u2500\u2500 bank/\n\u2502   \u2514\u2500\u2500 __init__.py\n\u251c\u2500\u2500 sonar_core_1/\n\u2502   \u2514\u2500\u2500 __init__.py\n\u251c\u2500\u2500 vntc/\n\u2502   \u2514\u2500\u2500 __init__.py\n\u2514\u2500\u2500 __init__.py\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"After:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"classification/\n\u251c\u2500\u2500 __init__.py      # Everything here\n\u2514\u2500\u2500 classification_prompt.py\n"})}),"\n",(0,r.jsx)(n.p,{children:"~190 lines removed, single source of truth for model URLs and loading logic."}),"\n",(0,r.jsx)(n.h2,{id:"try-it-out",children:"Try It Out"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pip install underthesea==9.2.9\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from underthesea import classify\n\n# 273x faster!\nclassify(\"Th\u1ecb tr\u01b0\u1eddng ch\u1ee9ng kho\xe1n t\u0103ng \u0111i\u1ec3m m\u1ea1nh\")\n# \"Kinh doanh\"\n\nclassify.labels\n# ['Chinh tri Xa hoi', 'Doi song', 'Khoa hoc', 'Kinh doanh', ...]\n\nclassify(\"M\u1edf th\u1ebb t\xedn d\u1ee5ng\", domain=\"bank\")\n# ['CARD']\n\nclassify.bank.labels\n# ['ACCOUNT', 'CARD', 'CUSTOMER_SUPPORT', ...]\n"})}),"\n",(0,r.jsx)(n.h2,{id:"links",children:"Links"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/undertheseanlp/underthesea/pull/935",children:"PR #935"})," - Classification pipeline refactor"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/undertheseanlp/sen-1",children:"Sen-1"})," - Training code and technical report"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://pypi.org/project/underthesea-core/",children:"underthesea-core"})," - Rust extension on PyPI"]}),"\n"]})]})}function o(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453(e,n,s){s.d(n,{R:()=>l,x:()=>d});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}},9413(e){e.exports=JSON.parse('{"permalink":"/underthesea/dev/blog/rust-text-classifier","editUrl":"https://github.com/undertheseanlp/underthesea/tree/main/docusaurus/blog/2026-02-03-rust-text-classifier.md","source":"@site/blog/2026-02-03-rust-text-classifier.md","title":"Rust-Powered Text Classification","description":"In underthesea v9.2.9, we\'ve completely rewritten the text classification pipeline using our Rust-based TextClassifier. This delivers up to 273x faster inference compared to the previous sklearn-based implementation.","date":"2026-02-03T00:00:00.000Z","tags":[{"inline":true,"label":"rust","permalink":"/underthesea/dev/blog/tags/rust"},{"inline":true,"label":"performance","permalink":"/underthesea/dev/blog/tags/performance"},{"inline":true,"label":"classification","permalink":"/underthesea/dev/blog/tags/classification"},{"inline":true,"label":"nlp","permalink":"/underthesea/dev/blog/tags/nlp"}],"readingTime":3.82,"hasTruncateMarker":true,"authors":[{"name":"Vu Anh","title":"Creator of Underthesea","url":"https://github.com/rain1024","imageURL":"https://github.com/rain1024.png","key":"rain1024","page":null}],"frontMatter":{"slug":"rust-text-classifier","title":"Rust-Powered Text Classification","authors":["rain1024"],"tags":["rust","performance","classification","nlp"]},"unlisted":false,"prevItem":{"title":"Rewriting FastText in Rust","permalink":"/underthesea/dev/blog/rewrite-fasttext-in-rust"},"nextItem":{"title":"Rewriting CRF Model in Rust","permalink":"/underthesea/dev/blog/rewrite-rust-crf-model"}}')}}]);