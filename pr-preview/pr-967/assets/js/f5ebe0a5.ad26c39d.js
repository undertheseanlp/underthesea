"use strict";(globalThis.webpackChunkunderthesea_docs=globalThis.webpackChunkunderthesea_docs||[]).push([[1440],{3927(e,s,r){r.r(s),r.d(s,{assets:()=>c,contentTitle:()=>t,default:()=>a,frontMatter:()=>l,metadata:()=>d,toc:()=>h});const d=JSON.parse('{"id":"api/core/lr","title":"Logistic Regression","description":"Classes for training and running logistic regression classifiers.","source":"@site/docs/api/core/lr.md","sourceDirName":"api/core","slug":"/api/core/lr","permalink":"/docs/api/core/lr","draft":false,"unlisted":false,"editUrl":"https://github.com/undertheseanlp/underthesea/tree/main/docusaurus/docs/api/core/lr.md","tags":[],"version":"current","frontMatter":{},"sidebar":"apiReferenceSidebar","previous":{"title":"CRF (Conditional Random Fields)","permalink":"/docs/api/core/crf"},"next":{"title":"Text Classifier","permalink":"/docs/api/core/text-classifier"}}');var n=r(4848),i=r(8453);const l={},t="Logistic Regression",c={},h=[{value:"LRTrainer",id:"lrtrainer",level:2},{value:"Usage",id:"usage",level:3},{value:"Constructor",id:"constructor",level:3},{value:"Parameters",id:"parameters",level:3},{value:"Methods",id:"methods",level:3},{value:"LRModel",id:"lrmodel",level:2},{value:"Usage",id:"usage-1",level:3},{value:"Constructor",id:"constructor-1",level:3},{value:"Static Methods",id:"static-methods",level:3},{value:"Properties",id:"properties",level:3},{value:"Methods",id:"methods-1",level:3},{value:"LRClassifier",id:"lrclassifier",level:2},{value:"Usage",id:"usage-2",level:3},{value:"Constructor",id:"constructor-2",level:3},{value:"Static Methods",id:"static-methods-1",level:3},{value:"Methods",id:"methods-2",level:3}];function o(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"logistic-regression",children:"Logistic Regression"})}),"\n",(0,n.jsx)(s.p,{children:"Classes for training and running logistic regression classifiers."}),"\n",(0,n.jsx)(s.h2,{id:"lrtrainer",children:"LRTrainer"}),"\n",(0,n.jsx)(s.p,{children:"Train a logistic regression model with SGD optimization."}),"\n",(0,n.jsx)(s.h3,{id:"usage",children:"Usage"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:'from underthesea_core import LRTrainer\n\nX_train = [\n    ["word=t\u1ed1t", "len=3"],\n    ["word=x\u1ea5u", "len=3"],\n    ["word=\u0111\u1eb9p", "len=3"],\n]\ny_train = ["positive", "negative", "positive"]\n\ntrainer = LRTrainer(\n    l2_penalty=0.01,\n    learning_rate=0.1,\n    max_epochs=100,\n    verbose=1,\n)\nmodel = trainer.train(X_train, y_train)\nmodel.save("lr_model.bin")\n'})}),"\n",(0,n.jsx)(s.h3,{id:"constructor",children:"Constructor"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:"LRTrainer(\n    l1_penalty=0.0,\n    l2_penalty=0.01,\n    learning_rate=0.1,\n    max_epochs=100,\n    batch_size=1,\n    tol=1e-4,\n    verbose=1,\n)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"parameters",children:"Parameters"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Parameter"}),(0,n.jsx)(s.th,{children:"Type"}),(0,n.jsx)(s.th,{children:"Default"}),(0,n.jsx)(s.th,{children:"Description"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"l1_penalty"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"float"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"0.0"})}),(0,n.jsx)(s.td,{children:"L1 regularization (lasso)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"l2_penalty"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"float"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"0.01"})}),(0,n.jsx)(s.td,{children:"L2 regularization (ridge)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"learning_rate"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"float"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"0.1"})}),(0,n.jsx)(s.td,{children:"Learning rate for SGD"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"max_epochs"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"int"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"100"})}),(0,n.jsx)(s.td,{children:"Maximum training epochs"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"batch_size"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"int"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"1"})}),(0,n.jsx)(s.td,{children:"Mini-batch size (1 = pure SGD)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"tol"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"float"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"1e-4"})}),(0,n.jsx)(s.td,{children:"Convergence tolerance for early stopping"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"verbose"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"int"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"1"})}),(0,n.jsx)(s.td,{children:"Verbosity: 0=quiet, 1=progress, 2=detailed"})]})]})]}),"\n",(0,n.jsx)(s.h3,{id:"methods",children:"Methods"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Method"}),(0,n.jsx)(s.th,{children:"Returns"}),(0,n.jsx)(s.th,{children:"Description"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"train(X, y)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"LRModel"})}),(0,n.jsx)(s.td,{children:"Train on feature lists X and labels y"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"set_l1_penalty(penalty)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"None"})}),(0,n.jsx)(s.td,{children:"Set L1 regularization"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"set_l2_penalty(penalty)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"None"})}),(0,n.jsx)(s.td,{children:"Set L2 regularization"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"set_learning_rate(lr)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"None"})}),(0,n.jsx)(s.td,{children:"Set learning rate"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"set_max_epochs(epochs)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"None"})}),(0,n.jsx)(s.td,{children:"Set maximum epochs"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"set_batch_size(size)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"None"})}),(0,n.jsx)(s.td,{children:"Set batch size"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"get_model()"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"LRModel"})}),(0,n.jsx)(s.td,{children:"Get the current model"})]})]})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"lrmodel",children:"LRModel"}),"\n",(0,n.jsx)(s.p,{children:"Stores trained logistic regression model weights and class labels."}),"\n",(0,n.jsx)(s.h3,{id:"usage-1",children:"Usage"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:'from underthesea_core import LRModel\n\n# Load a saved model\nmodel = LRModel.load("lr_model.bin")\nprint(model.num_classes)    # number of classes\nprint(model.num_features)   # number of features\nprint(model.get_classes())  # list of class labels\n\n# Create with predefined classes\nmodel = LRModel.with_classes(["positive", "negative"])\n'})}),"\n",(0,n.jsx)(s.h3,{id:"constructor-1",children:"Constructor"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:"LRModel()\n"})}),"\n",(0,n.jsx)(s.h3,{id:"static-methods",children:"Static Methods"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Method"}),(0,n.jsx)(s.th,{children:"Returns"}),(0,n.jsx)(s.th,{children:"Description"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"load(path)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"LRModel"})}),(0,n.jsx)(s.td,{children:"Load model from file"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"with_classes(classes)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"LRModel"})}),(0,n.jsx)(s.td,{children:"Create model with predefined classes"})]})]})]}),"\n",(0,n.jsx)(s.h3,{id:"properties",children:"Properties"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Property"}),(0,n.jsx)(s.th,{children:"Type"}),(0,n.jsx)(s.th,{children:"Description"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"num_classes"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"int"})}),(0,n.jsx)(s.td,{children:"Number of classes"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"num_features"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"int"})}),(0,n.jsx)(s.td,{children:"Number of features"})]})]})]}),"\n",(0,n.jsx)(s.h3,{id:"methods-1",children:"Methods"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Method"}),(0,n.jsx)(s.th,{children:"Returns"}),(0,n.jsx)(s.th,{children:"Description"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"save(path)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"None"})}),(0,n.jsx)(s.td,{children:"Save model to file"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"get_classes()"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"list[str]"})}),(0,n.jsx)(s.td,{children:"Get all class labels"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"num_weights()"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"int"})}),(0,n.jsx)(s.td,{children:"Get number of non-zero weights"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"l2_norm_squared()"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"float"})}),(0,n.jsx)(s.td,{children:"Get L2 norm squared of all weights"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"l1_norm()"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"float"})}),(0,n.jsx)(s.td,{children:"Get L1 norm of all weights"})]})]})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"lrclassifier",children:"LRClassifier"}),"\n",(0,n.jsx)(s.p,{children:"Load a trained LR model and make predictions."}),"\n",(0,n.jsx)(s.h3,{id:"usage-2",children:"Usage"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:'from underthesea_core import LRClassifier\n\n# Load from file\nclassifier = LRClassifier.load("lr_model.bin")\n\n# Or create from model\nfrom underthesea_core import LRModel\nmodel = LRModel.load("lr_model.bin")\nclassifier = LRClassifier.from_model(model)\n\n# Predict\nfeatures = ["word=t\u1ed1t", "len=3"]\nlabel = classifier.predict(features)\n\n# Predict with probability\nlabel, prob = classifier.predict_with_prob(features)\n\n# Get probability distribution\nproba = classifier.predict_proba(features)\n# [("positive", 0.85), ("negative", 0.15)]\n\n# Get top-k predictions\ntop2 = classifier.predict_top_k(features, k=2)\n'})}),"\n",(0,n.jsx)(s.h3,{id:"constructor-2",children:"Constructor"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:"LRClassifier()\n"})}),"\n",(0,n.jsx)(s.h3,{id:"static-methods-1",children:"Static Methods"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Method"}),(0,n.jsx)(s.th,{children:"Returns"}),(0,n.jsx)(s.th,{children:"Description"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"load(path)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"LRClassifier"})}),(0,n.jsx)(s.td,{children:"Load classifier from file"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"from_model(model)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"LRClassifier"})}),(0,n.jsxs)(s.td,{children:["Create classifier from an ",(0,n.jsx)(s.code,{children:"LRModel"})]})]})]})]}),"\n",(0,n.jsx)(s.h3,{id:"methods-2",children:"Methods"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Method"}),(0,n.jsx)(s.th,{children:"Returns"}),(0,n.jsx)(s.th,{children:"Description"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"predict(features)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"str"})}),(0,n.jsx)(s.td,{children:"Predict the most likely class"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"predict_with_prob(features)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"(str, float)"})}),(0,n.jsx)(s.td,{children:"Predict with probability"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"predict_proba(features)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"list[(str, float)]"})}),(0,n.jsx)(s.td,{children:"Get probability distribution over all classes"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"predict_top_k(features, k)"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"list[(str, float)]"})}),(0,n.jsx)(s.td,{children:"Get top-k most likely classes with probabilities"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"num_classes()"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"int"})}),(0,n.jsx)(s.td,{children:"Get number of classes"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"classes()"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"list[str]"})}),(0,n.jsx)(s.td,{children:"Get all class labels"})]})]})]})]})}function a(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}},8453(e,s,r){r.d(s,{R:()=>l,x:()=>t});var d=r(6540);const n={},i=d.createContext(n);function l(e){const s=d.useContext(i);return d.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),d.createElement(i.Provider,{value:s},e.children)}}}]);